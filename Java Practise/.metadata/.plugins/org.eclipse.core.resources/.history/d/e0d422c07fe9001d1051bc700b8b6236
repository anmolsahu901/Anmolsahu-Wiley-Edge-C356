package Customer.java;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;

public class Customer {
	ArrayList<Product> cart;
	HashMap<String,String> productList;
	// name , id +$+price

	Customer(String csvFile){
		cart = new ArrayList<>();
		productList = new HashMap<>();
//		String csvFile = "product.csv";
		String line = "";
		String csvDelimiter = ",";
//		ArrayList<Product> List = new ArrayList<Product>();

		try (BufferedReader br = new BufferedReader(new FileReader(csvFile))) {
			// skip the header line
			br.readLine();

			while ((line = br.readLine()) != null) {
				String[] productData = line.split(csvDelimiter);
//				Product product = new Product(Integer.parseInt(productData[0]), productData[1], Double.parseDouble(productData[2]));
//				productList.add(product);
				String details = ""+productData[0]+"$"+productData[2];
				productList.put(productData[1], details);
				
				
			}

			System.out.println(productList);
			// print the productList to verify it was read correctly
			
		} catch (IOException e) {
			e.printStackTrace();
		}
		
	}

	void viewProducts(String fileName) {
		//fetch data from csv and store it in hashmap
		//print arraylist
		System.out.println("inside view ");
		/*String csvFile = "product.csv";
		String line = "";
		String csvDelimiter = ",";
//		ArrayList<Product> List = new ArrayList<Product>();

		try (BufferedReader br = new BufferedReader(new FileReader(csvFile))) {
			// skip the header line
			br.readLine();

			while ((line = br.readLine()) != null) {
				String[] productData = line.split(csvDelimiter);
//				Product product = new Product(Integer.parseInt(productData[0]), productData[1], Double.parseDouble(productData[2]));
//				productList.add(product);
				String details = productData[0]+"$"+productData[2];
				productList.put(productData[1], details);
				
				
			}


			// print the productList to verify it was read correctly
			
		} catch (IOException e) {
			e.printStackTrace();
		}*/

	}

	boolean searchProduct(String name) {
		return productList.containsKey(name); 
	}

	void addToCart(String name) {
		String productdetails = productList.get(name);
		String []sp =  productdetails.split("$");  // id +$+price
		int id = Integer.valueOf(sp[0]);
		double price = Double.valueOf(sp[1]);
		Product obj = new Product(id,name,price); 
		System.out.println(obj);
		cart.add(obj);
	}


	boolean removeProduct(String name){
		String productdetails = productList.get(name);
		String []sp =  productdetails.split("$");  // id +$+price
		int id = Integer.valueOf(sp[0]);
		double price = Double.valueOf(sp[1]);
		Product obj = new Product(id,name,price); 

		if(cart.contains(obj)){
			cart.remove(obj);
			System.out.println("Product removed !");
			return true;
		}
		return false;     
	}



	void viewCart() {
		System.out.println("All Cart Items:");
		System.out.println("********************************************");
		for(int i=0;i<cart.size();i++) {
			Product curr=cart.get(i);
			System.out.println((i+1)+"). "+curr.getId()+"\t"+curr.getName()+"\t"+curr.getPrice());
		}
	}

	void pay() {
		//call funtion of payment class and pass
		System.out.println("Call function of payment class and pass arrayList");
	}

	public static void main(String[] args) {
		Customer obj = new Customer("product.csv");
//		obj.viewProducts("demo");
		
//		obj.addToCart("Watch");
//		obj.addToCart("Suitcase");
		System.out.println(obj.searchProduct("Suitcase"));

		obj.viewCart();
	}

}
